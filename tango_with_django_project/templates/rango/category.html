{% extends 'rango/base.html' %}

{% block title %}{{ category_name }}{% endblock %}

{% block body_block %}
<div class="hero-unit">
    <h1>{{ category_name }}</h1>
    

    {% if category %}
        <p>
            <b id='like_count'>{{ category.likes }}</b> people like this category

            {% if user.is_authenticated %}
                <button id='likes' data-catid='{{category.id}}' class='btn btn-mini btn-primary' type='button'>Like</button>
            {% endif %}
        </p>

        <div id='pages'>
        {% if pages %}
        <ul>
            {% for page in pages %}
            <li>
                <a href="/rango/goto/?page_id={{ page.id }}">{{ page.title }} - {{page.views}} view(s)</a>
            </li>
            {% endfor %}
        </ul>
        {% else %}
            <strong>No pages currently in category.</strong>
        {% endif %}

        {% if user.is_authenticated %}
           <a href="/rango/category/{{category_name_url}}/add_page/">Add a Page</a>
        {% endif %}
        </div>

        <div class="hero-unit">
            <div class="container-fluid">
                <p>Search for a page.</p>
                <form class="span8 form-search" id="search_form" method="post" action="/rango/category/{{ category_name_url }}/">
                    {% csrf_token %}
                    <!-- Display the search form elements here -->
                    <input type="text" class="input-long search-query" name="query" value="{{ category_name }}" id="query" />
                    <input type="submit" class="btn btn-primary" name="submit" value="Search" />
                    <br />
                </form>
            </div>

            <div class='container-fluid'>
                {% if result_list %}
                <!-- Display search results in an ordered list -->
                <ol>
                {% for result in result_list %}
                    <li>
                        <strong><a href="{{ result.link }}">{{ result.title }}</a></strong><br />
                        <em>{{ result.summary }}</em>
                    </li>
                {% endfor %}
                </ol>
                {% endif %}
            </div>
        </div>        

    {% else %}
        <strong>No categories are present.</strong>
    {% endif %}

</div>
{% endblock %}